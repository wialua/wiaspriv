-- üì¶ K√ºt√ºphane y√ºklemeleri (dosyanƒ±n ba≈üƒ±nda olmalƒ±)
local repo = 'https://raw.githubusercontent.com/violin-suzutsuki/LinoriaLib/main/'
local Library = loadstring(game:HttpGet(repo .. 'Library.lua'))()
local ThemeManager = loadstring(game:HttpGet(repo .. 'addons/ThemeManager.lua'))()
local SaveManager = loadstring(game:HttpGet(repo .. 'addons/SaveManager.lua'))()

local Window = Library:CreateWindow({
    Title = 'Wia Men√º | Beta',
    Center = true,
    AutoShow = true
})

local CombatTab = Window:AddTab("‚öîÔ∏è Combat")
local SilentAimTab = Window:AddTab("üéØ Silent Aim")
local VehicleTab = Window:AddTab("üöó Ara√ß")
local ServerTab = Window:AddTab("Server")

-- Combat i√ßin ESP Ara√ßlarƒ± kƒ±smƒ±
local CombatGroup = CombatTab:AddLeftGroupbox('ESP Ara√ßlarƒ±')

-- üö® ESP A√ß butonu
CombatGroup:AddButton('ESP A√ß', function()
    local Players = game:GetService("Players")

    local function fixNameTag(player)
        local function apply()
            local char = player.Character
            if not char then return end
            local nameTag = char:FindFirstChild("NameTag")
            if nameTag then
                nameTag.AlwaysOnTop = true
                nameTag.MaxDistance = 10000
            end
        end
        if player.Character then apply() end
        player.CharacterAdded:Connect(function(char)
            char:WaitForChild("NameTag", 10)
            apply()
            local nameTag = char:FindFirstChild("NameTag")
            if nameTag then
                nameTag:GetPropertyChangedSignal("AlwaysOnTop"):Connect(function()
                    nameTag.AlwaysOnTop = true
                end)
            end
        end)
    end

    -- Apply the ESP fix to all players currently in the game
    for _, player in ipairs(Players:GetPlayers()) do
        fixNameTag(player)
    end

    -- Apply ESP when new players join the game
    Players.PlayerAdded:Connect(fixNameTag)
end)

-- üö® ESP Kapat butonu
CombatGroup:AddButton('ESP Kapat', function()
    local Players = game:GetService("Players")

    -- Disable the ESP for all players
    for _, player in pairs(Players:GetPlayers()) do
        local character = player.Character or player.CharacterAdded:Wait()
        local nameTag = character:FindFirstChild("NameTag")
        if nameTag then
            nameTag.AlwaysOnTop = false
            nameTag.MaxDistance = 200
        end
    end

    -- Disable ESP for new players that join the game
    Players.PlayerAdded:Connect(function(player)
        player.CharacterAdded:Connect(function(character)
            local nameTag = character:WaitForChild("NameTag", 10)
            if nameTag then
                nameTag.AlwaysOnTop = false
                nameTag.MaxDistance = 200
            end
        end)
    end)
end)

-- üí• Shotgun Crash butonu
local CrashGroup = CombatTab:AddLeftGroupbox('Crash')

CrashGroup:AddButton('üí• Shotgun Crash', function()
    task.spawn(function()
        pcall(function()
            local plr = game.Players.LocalPlayer
            local ReplicatedStorage = game:GetService("ReplicatedStorage")

            -- Check if Shotgun is in the player's backpack
            if not plr.Backpack:FindFirstChild("Shotgun") then
                game.StarterGui:SetCore("SendNotification", {
                    Title = "Uyarƒ±",
                    Text = "Shotgun envanterinde ve elinde olmalƒ±!",
                    Duration = 5
                })
                return
            end

            -- Process when the player has the Shotgun
            local char = plr.Character
            if char and char:FindFirstChildOfClass("Humanoid") then
                -- Event spam for Shotgun (20 times)
                for i = 1, 20 do
                    task.wait()
                    local shotgun = workspace:FindFirstChild("ObjectSelection") and workspace.ObjectSelection:FindFirstChild("Shotgun")
                    if shotgun and shotgun:FindFirstChild("Shotgun") and shotgun.Shotgun:FindFirstChild("Shotgun") then
                        shotgun.Shotgun.Shotgun.Event:FireServer()
                    end
                end

                -- Equip the Shotgun
                char.Humanoid:EquipTool(plr.Backpack:FindFirstChild("Shotgun"))

                -- Spam ShootShotgun event 8000 times
                for i = 1, 8000 do
                    ReplicatedStorage.Event:FireServer("ShootShotgun", workspace[plr.Name], Vector3.new(0, 0, 0), "Shotgun", "inf", "inf", "inf")
                end

                -- Send a crash notification to the user
                game.StarterGui:SetCore("SendNotification", {
                    Title = "üí• C R A S H",
                    Text = "Sunucu √ß√∂kt√º!",
                    Duration = 7
                })
            end
        end)
    end)
end)

-- üöó Sekme adƒ±: Ara√ß


-- üîΩ Sol kutu: Ara√ß se√ß + spawn
local VehicleSpawnBox = VehicleTab:AddLeftGroupbox("üöò Ara√ß Spawn")
local selectedVehicle = "Nero"
local vehicleList = { "Nero", "Nighthawk", "Fury", "Rhino", "Warhawk", "Light Bike", "Buzzard" }

VehicleSpawnBox:AddDropdown("VehicleDropdown", {
    Values = vehicleList,
    Default = 1,
    Text = "Ara√ß Se√ß",
    Tooltip = "Spawnlamak istediƒüin aracƒ± se√ß.",
    Callback = function(value)
        selectedVehicle = value
    end
})

VehicleSpawnBox:AddButton("üöÄ Aracƒ± Spawnla", function()
    if selectedVehicle and selectedVehicle ~= "" then
        game:GetService("ReplicatedStorage").Event:FireServer("SpawnVehicle", selectedVehicle)
        print("Spawnlandƒ±:", selectedVehicle)
    end
end)

-- üõ†Ô∏è Saƒü kutu: Modifiye butonlarƒ±
local VehicleModBox = VehicleTab:AddRightGroupbox("üõ†Ô∏è Ara√ß Modifiye")

-- Ortak fonksiyon: t√ºm ara√ßlara uygulama
local function applyPropertiesToAll(propertyTable)
    for _, obj in pairs(getgc(true)) do
        if type(obj) == "table" then
            for property, value in pairs(propertyTable) do
                if rawget(obj, property) then
                    obj[property] = value
                end
            end
        end
    end
end

-- üîß Araba
VehicleModBox:AddButton("üöÄ Araba Modifiye Et", function()
    local carProperties = {
        Torque = 5,
        BrakeForce = 4,
        MaxSpeed = 400,
        TurnSpeed = 1.7,
        DriftVelLerp = 0.45,
        DriftRotLerp = 0.12,
    }
    applyPropertiesToAll(carProperties)

    -- Boost
    local playerVehicle = workspace.ObjectSelection:FindFirstChild(game.Players.LocalPlayer.Name.."'s Vehicle")
    if playerVehicle then
        pcall(function()
            local chassis = playerVehicle:FindFirstChild("CarChassis")
            if chassis then
                local boost = chassis:FindFirstChild("Boost")
                if boost then boost.Value = 20 end
            end
        end)
    end
end)

-- üöÅ Helikopter
VehicleModBox:AddButton("üöÅ Helikopter Modifiye Et", function()
    local props = {
        Acceleration = 3,
        Deceleration = 1,
        SpeedDecay = 0.95,
        BrakeForce = 15,
        DescentSpeed = 2,
        MaxVerticalTiltAngle = 25,
        VerticalTiltSpeed = 0.3,
        HorizontalRotationSpeed = 8.5,
        ResponseSpeed = 1,
        MaxSideTilt = 20,
        MinHeightAboveGround = 5,
        MissileCooldown = 2,
        MissileLock = 0,
    }
    applyPropertiesToAll(props)
end)

-- üõ∏ UFO
VehicleModBox:AddButton("üõ∏ UFO Modifiye Et", function()
    local props = {
        Acceleration = 10,
        Deceleration = 1,
        SpeedDecay = 0.95,
        BrakeForce = 15,
        MaxAltitude = 640,
        AscentSpeed = 2,
        DescentSpeed = 3,
        MaxVerticalTiltAngle = 25,
        VerticalTiltSpeed = 0.3,
        HorizontalRotationSpeed = 8.5,
        ResponseSpeed = 1,
        HideCharacter = true,
        MaxSideTilt = 20,
        MinHeightAboveGround = 5,
        CameraOffset = 40
    }
    applyPropertiesToAll(props)
end)

-- üö§ Tekne
VehicleModBox:AddButton("üö§ Tekne Modifiye Et", function()
    local props = {
        Height = 1,
        TurnSpeed = 5.7,
        Torque = 5,
        MaxSpeed = 160,
        BrakeForce = 1,
        SpeedDecay = 0.5,
    }
    applyPropertiesToAll(props)
end)

-- ‚úàÔ∏è U√ßak
VehicleModBox:AddButton("‚úàÔ∏è U√ßak Modifiye Et", function()
    local props = {
        MaxSpeed = 270,
        Acceleration = 2,
        Bombs = true,
        DampeningAcceleration = 0.8,
        MaxVerticalTilt = 10,
        VerticalTiltUpSpeed = 1,
        VerticalTiltDownSpeed = 1,
        VerticalTiltDampening = 0.95,
        VerticalSpeedLimit = 30,
        HorizontalTiltSpeed = 7.4,
        MaxSideTilt = 25,
        SideTiltSpeed = 1.5,
        SideTiltDampening = 0.95,
        MissileTargetRange = 540,
        MissileCooldown = 2,
        MissileLock = 0
    }
    applyPropertiesToAll(props)
end)

-- üí£ Sonsuz Bombalama
local bombLoopStarted = false

VehicleSpawnBox:AddButton("üí£ Sonsuz Bombalama", function()
    if bombLoopStarted then return end -- Bir kez √ßalƒ±≈ütƒ±rƒ±lƒ±r
    bombLoopStarted = true

    local Remote = game.ReplicatedStorage:WaitForChild("Event")
    local UserInputService = game:GetService("UserInputService")

    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if not gameProcessed and input.KeyCode == Enum.KeyCode.G then
            Remote:FireServer("DropBomb")
        end
    end)

    print("üí£ Sonsuz bombalama aktif. G tu≈üuna basƒ±nca bomba bƒ±rakƒ±lacak.")
end)

-- ‚úÖ Yeni i≈ülev: Text mesajƒ± ekleme
local function showMessageFor5Seconds(message)
    -- Create a text label
    local textLabel = Instance.new("TextLabel")
    textLabel.Text = message
    textLabel.FontSize = Enum.FontSize.Size24
    textLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.Position = UDim2.new(0.5, -150, 0.9, -30) -- Position it near the bottom of the screen
    textLabel.Size = UDim2.new(0, 300, 0, 50)
    textLabel.AnchorPoint = Vector2.new(0.5, 0.5)
    textLabel.Parent = game.CoreGui

    -- Animate the label fading out after 5 seconds
    game:GetService("TweenService"):Create(textLabel, TweenInfo.new(5), {TextTransparency = 1}):Play()

    -- Remove the label after 5 seconds
    wait(5)
    textLabel:Destroy()
end

-- üö® Hooking wait function on button click and show the message
local buttonClicked = false
VehicleSpawnBox:AddButton("üî•Sƒ±nƒ±rsƒ±z Tank Ate≈ülemeüî•", function()
    if buttonClicked then
        print("Already clicked!")
        return
    end

    local old
    old = hookfunction(wait, function(time)
        if time == 6.5 then
            return old(0)
        end
        return old(time)
    end)

    buttonClicked = true

    -- Show a message for 5 seconds after button click
    showMessageFor5Seconds("Wait function has been hooked!")

end)

-- Silent Aim sekmesinde dropdown olu≈üturulmasƒ±

--===[ Ayarlar ve Ba≈ülangƒ±√ß ]===--
local SilentAimGroup = SilentAimTab:AddLeftGroupbox("üéØ Oyuncu Se√ßimi")

local maxDistance = 10000
local blacklistedName = "MAD_CITYAIMBOTLOL"
local ESPFolder = Instance.new("Folder", game.CoreGui)
ESPFolder.Name = "SilentAimEffects"

local selectedPlayer = nil
local toggleActive = false

--===[ Yardƒ±mcƒ± Fonksiyonlar ]===--
local function getPlayerNames()
    local list = {}
    for _, player in ipairs(game.Players:GetPlayers()) do
        if player ~= game.Players.LocalPlayer then
            table.insert(list, player.Name)
        end
    end
    return list
end

local function createBillboard(player)
    if ESPFolder:FindFirstChild(player.Name) then return end
    local char = player.Character
    if not char or not char:FindFirstChild("Head") then return end

    local billboard = Instance.new("BillboardGui", ESPFolder)
    billboard.Name = player.Name
    billboard.Adornee = char:FindFirstChild("Head")
    billboard.Size = UDim2.new(0, 60, 0, 60)
    billboard.StudsOffset = Vector3.new(0, 2, 0)
    billboard.AlwaysOnTop = true

    local frame = Instance.new("Frame", billboard)
    frame.BackgroundTransparency = 1
    frame.Size = UDim2.new(1, 0, 1, 0)
    frame.ClipsDescendants = true

    local avatar = Instance.new("ImageLabel", frame)
    avatar.Size = UDim2.new(1, 0, 1, 0)
    avatar.BackgroundTransparency = 1
    avatar.Image = string.format("https://www.roblox.com/headshot-thumbnail/image?userId=%s&width=150&height=150&format=png", player.UserId)
    avatar.ScaleType = Enum.ScaleType.Fit

    local healthBar = Instance.new("Frame", frame)
    healthBar.BackgroundColor3 = Color3.new(0, 1, 0)
    healthBar.BorderSizePixel = 0
    healthBar.Position = UDim2.new(0, 0, 1, -4)
    healthBar.Size = UDim2.new(1, 0, 0, 4)
    healthBar.Name = "HealthBar"

    local outline = Instance.new("UIStroke", avatar)
    outline.Thickness = 2
    outline.Color = player.Team and player.Team.TeamColor.Color or Color3.new(1, 1, 1)
    outline.Transparency = 0.25

    task.spawn(function()
        while toggleActive and billboard and player.Character and player.Character:FindFirstChild("Humanoid") do
            local hp = player.Character.Humanoid.Health
            local max = player.Character.Humanoid.MaxHealth
            healthBar.Size = UDim2.new(hp/max, 0, 0, 4)
            task.wait(0.2)
        end
        if billboard then billboard:Destroy() end
    end)
end

local function killEffect(position)
    local part = Instance.new("Part", workspace)
    part.Anchored = true
    part.CanCollide = false
    part.Position = position
    part.Size = Vector3.new(1, 1, 1)
    part.Transparency = 1
    part.Name = "BloodEmitterAnchor"

    local blood = Instance.new("ParticleEmitter", part)
    blood.Texture = "rbxassetid://241837157"
    blood.Lifetime = NumberRange.new(0.5, 1)
    blood.Rate = 1000
    blood.Speed = NumberRange.new(30, 60)
    blood.Size = NumberSequence.new({
        NumberSequenceKeypoint.new(0, 1),
        NumberSequenceKeypoint.new(1, 0)
    })
    blood.Color = ColorSequence.new(Color3.fromRGB(255, 0, 0))
    blood.LightEmission = 1
    blood.VelocitySpread = 180
    blood.Acceleration = Vector3.new(0, -20, 0)

    task.delay(5, function()
        part:Destroy()
    end)
end

local function showNotification(text, color)
    local screenGui = Instance.new("ScreenGui", game.CoreGui)
    screenGui.Name = "SilentAimNotification"

    local label = Instance.new("TextLabel", screenGui)
    label.AnchorPoint = Vector2.new(0.5, 0.5)
    label.Position = UDim2.new(0.5, 0, 0.2, 0)
    label.Size = UDim2.new(0, 400, 0, 50)
    label.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    label.BackgroundTransparency = 0.1
    label.TextColor3 = color or Color3.new(1, 1, 1)
    label.Text = text
    label.Font = Enum.Font.GothamBold
    label.TextScaled = true
    label.TextStrokeTransparency = 0.6
    label.TextStrokeColor3 = Color3.new(0, 0, 0)
    label.BorderSizePixel = 0

    local stroke = Instance.new("UIStroke", label)
    stroke.Thickness = 2
    stroke.Color = color or Color3.new(1, 1, 1)

    task.delay(2, function()
        screenGui:Destroy()
    end)
end

--===[ UI: Dropdown ve Toggle ]===--
SilentAimGroup:AddDropdown("PlayerListDropdown", {
    Values = getPlayerNames(),
    Default = 1,
    Text = "Oyuncu Se√ß",
    Tooltip = "Silent Aim i√ßin hedef oyuncuyu se√ß.",
    Callback = function(value)
        if value == blacklistedName then
            showNotification("BU OYUNCUYA Sƒ∞LENT AIM KULLANAMAZSIN!", Color3.new(1, 0, 0))
            selectedPlayer = nil
        else
            selectedPlayer = game.Players:FindFirstChild(value)
            if toggleActive and selectedPlayer then
                createBillboard(selectedPlayer)
            end
        end
    end
})

SilentAimGroup:AddToggle("EnableSilentAim", {
    Text = "Silent Aim A√ßƒ±k/Kapalƒ±",
    Default = false,
    Callback = function(state)
        toggleActive = state
        if not state then
            for _, v in pairs(ESPFolder:GetChildren()) do
                v:Destroy()
            end
        elseif selectedPlayer then
            createBillboard(selectedPlayer)
        end
    end
})

--===[ Mouse Sol Tƒ±klama: VR ve Efekt ]===--
game:GetService("UserInputService").InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed or input.UserInputType ~= Enum.UserInputType.MouseButton1 then return end
    if not toggleActive or not selectedPlayer then return end

    local char = selectedPlayer.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") or not char:FindFirstChild("Humanoid") then return end

    local distance = (char.HumanoidRootPart.Position - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
    if distance <= maxDistance then
        local oldHp = char.Humanoid.Health
        game:GetService("ReplicatedStorage").Event:FireServer("VR", char.HumanoidRootPart)
        killEffect(char.HumanoidRootPart.Position)

        task.delay(0.2, function()
            if char and char:FindFirstChild("Humanoid") then
                local newHp = char.Humanoid.Health
                if newHp <= 0 then
                    showNotification("HEDEF √ñLD√úR√úLD√ú", Color3.new(1, 0, 0))
                elseif newHp < oldHp then
                    showNotification("HEDEFE HASAR VERƒ∞LDƒ∞", Color3.new(1, 1, 0))
                end
            end
        end)
    end
end)

--===[ Oyuncu Listesi G√ºncel Kalmalƒ± ]===--
game.Players.PlayerAdded:Connect(function()
    SilentAimGroup:UpdateDropdown("PlayerListDropdown", {
        Values = getPlayerNames(),
    })
end)

game.Players.PlayerRemoving:Connect(function()
    SilentAimGroup:UpdateDropdown("PlayerListDropdown", {
        Values = getPlayerNames(),
    })
end)


-- Saƒü tarafta Silent Aim i√ßin Toggle ve Dropdown
local SilentAimRightGroup = SilentAimTab:AddRightGroupbox("üéØ Silent Aim Saƒü Taraf")

-- Saƒü tarafta Dropdown ekle
SilentAimRightGroup:AddDropdown("PlayerListDropdownRight", {
    Values = getPlayerNames(),
    Default = 1,
    Text = "Hedef Oyuncu Se√ß",
    Tooltip = "Saƒü Tarafta Silent Aim i√ßin hedef oyuncuyu se√ß.",
    Callback = function(value)
        selectedPlayer = game.Players:FindFirstChild(value) -- Se√ßilen oyuncuyu bul
        print("Se√ßilen oyuncu: " .. value)
    end
})

-- Saƒü tarafta Silent Aim Toggle
SilentAimRightGroup:AddToggle("EnableSilentAimRight", {
    Text = "Silent Aim (Saƒü Taraf)",
    Default = false,
    Callback = function(value)
        -- Toggle aktifse, F tu≈üuna basƒ±ldƒ±ƒüƒ±nda i≈ülemi ger√ßekle≈ütireceƒüiz
        if value then
            game:GetService("UserInputService").InputBegan:Connect(function(input, gameProcessed)
                if gameProcessed then return end  -- Eƒüer oyun tarafƒ±ndan i≈üleniyorsa, ge√ß

                -- F tu≈üuna basƒ±ldƒ±ƒüƒ±nda
                if input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode == Enum.KeyCode.F then
                    -- Se√ßilen oyuncu var mƒ± kontrol et
                    if selectedPlayer then
                        -- Se√ßilen oyuncunun karakteri
                        local targetCharacter = selectedPlayer.Character
                        if targetCharacter then
                            local humanoidRootPart = targetCharacter:FindFirstChild("HumanoidRootPart")
                            if humanoidRootPart then
                                -- Canlƒ± konumu al
                                local playerPosition = humanoidRootPart.CFrame.Position

                                -- ShootTank event'ini tetikle
                                local args1 = {
                                    [1] = "ShootTank",
                                    [2] = workspace:WaitForChild("Emiraganz"),
                                    [3] = workspace:WaitForChild("ObjectSelection"):WaitForChild("Emiraganz's Vehicle"):WaitForChild("Body"),
                                    [4] = playerPosition
                                }
                                game:GetService("ReplicatedStorage").Event:FireServer(unpack(args1))

                                -- TA event'ini tetikle
                                local args2 = {
                                    [1] = "TA",
                                    [2] = playerPosition
                                }
                                game:GetService("ReplicatedStorage"):WaitForChild("Event"):FireServer(unpack(args2))

                                print("ShootTank ve TA event'leri tetiklendi: " .. selectedPlayer.Name)
                            else
                                print("Se√ßilen oyuncunun HumanoidRootPart'ƒ± bulunamadƒ±.")
                            end
                        else
                            print("Se√ßilen oyuncunun karakteri yok.")
                        end
                    end
                end
            end)
        end
    end
})

local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")

local localPlayer = Players.LocalPlayer
local placeId = game.PlaceId
local maxPlayers = 28

-- Server sekmesini alƒ±yoruz
local ServerHopBox = ServerTab:AddLeftGroupbox("üîÄ ServerHop")

local function findAndHop()
    local success, response = pcall(function()
        return HttpService:JSONDecode(game:HttpGet(
            string.format("https://games.roblox.com/v1/games/%d/servers/Public?sortOrder=Asc&limit=100", placeId)
        ))
    end)

    if not success or not response or not response.data then
        return warn("[ServerHop Hata]: Sunucu verileri alƒ±namadƒ±.")
    end

    for _, server in ipairs(response.data) do
        if server.playing < maxPlayers and server.id ~= game.JobId then
            local valid = true

            if filterEmpty and server.playing >= 10 then valid = false end
            if filterFull and server.playing < 26 then valid = false end

            if valid then
                print("Ge√ßi≈ü yapƒ±lƒ±yor sunucu:", server.id, "Oyuncular:", server.playing)
                TeleportService:TeleportToPlaceInstance(placeId, server.id, localPlayer)
                return
            end
        end
    end

    warn("[ServerHop Hata]: Uygun sunucu bulunamadƒ±.")
end

-- Butonlar
ServerHopBox:AddButton("üîÑ Sunucu Deƒüi≈ütir", function()
    print("Sunucu aranƒ±yor...")
    findAndHop()
end)

ServerHopBox:AddButton("‚ôªÔ∏è Sunucuya Tekrar Katƒ±l", function()
    TeleportService:TeleportToPlaceInstance(placeId, game.JobId, localPlayer)
end):AddTooltip("Aynƒ± sunucuya garanti ≈üekilde yeniden baƒülanƒ±r.")
