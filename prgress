local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")
local HttpService = game:GetService("HttpService")

local Player = Players.LocalPlayer

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ModernLoader" .. math.random(1000, 9999)
ScreenGui.ResetOnSpawn = false
ScreenGui.IgnoreGuiInset = true
ScreenGui.DisplayOrder = 1000
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Parent = CoreGui

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 400, 0, 300)
MainFrame.Position = UDim2.new(0.5, -200, 0.5, -150)
MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
MainFrame.BorderSizePixel = 0
MainFrame.ClipsDescendants = true
MainFrame.Parent = ScreenGui

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 20)
MainCorner.Parent = MainFrame

local MainGradient = Instance.new("UIGradient")
MainGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(25, 25, 40)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(10, 10, 20))
}
MainGradient.Rotation = 45
MainGradient.Parent = MainFrame

local MainStroke = Instance.new("UIStroke")
MainStroke.Color = Color3.fromRGB(100, 150, 255)
MainStroke.Thickness = 2
MainStroke.Transparency = 0.3
MainStroke.Parent = MainFrame

local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Size = UDim2.new(1, -60, 0, 60)
Title.Position = UDim2.new(0, 30, 0, 30)
Title.BackgroundTransparency = 1
Title.Text = "Modern Loader"
Title.TextColor3 = Color3.fromRGB(200, 200, 255)
Title.TextScaled = true
Title.Font = Enum.Font.GothamBold
Title.Parent = MainFrame

local Subtitle = Instance.new("TextLabel")
Subtitle.Name = "Subtitle"
Subtitle.Size = UDim2.new(1, -60, 0, 40)
Subtitle.Position = UDim2.new(0, 30, 0, 100)
Subtitle.BackgroundTransparency = 1
Subtitle.Text = "Yükleniyor..."
Subtitle.TextColor3 = Color3.fromRGB(150, 150, 200)
Subtitle.TextScaled = true
Subtitle.Font = Enum.Font.Gotham
Subtitle.Parent = MainFrame

local ProgressBar = Instance.new("Frame")
ProgressBar.Name = "ProgressBar"
ProgressBar.Size = UDim2.new(1, -60, 0, 20)
ProgressBar.Position = UDim2.new(0, 30, 0, 150)
ProgressBar.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
ProgressBar.BorderSizePixel = 0
ProgressBar.Parent = MainFrame

local ProgressCorner = Instance.new("UICorner")
ProgressCorner.CornerRadius = UDim.new(0, 10)
ProgressCorner.Parent = ProgressBar

local ProgressFill = Instance.new("Frame")
ProgressFill.Name = "ProgressFill"
ProgressFill.Size = UDim2.new(0, 0, 1, 0)
ProgressFill.Position = UDim2.new(0, 0, 0, 0)
ProgressFill.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
ProgressFill.BorderSizePixel = 0
ProgressFill.Parent = ProgressBar

local FillCorner = Instance.new("UICorner")
FillCorner.CornerRadius = UDim.new(0, 10)
FillCorner.Parent = ProgressFill

local FillGradient = Instance.new("UIGradient")
FillGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(100, 150, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(50, 100, 200))
}
FillGradient.Parent = ProgressFill

local StatusLabel = Instance.new("TextLabel")
StatusLabel.Name = "StatusLabel"
StatusLabel.Size = UDim2.new(1, -60, 0, 30)
StatusLabel.Position = UDim2.new(0, 30, 0, 180)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = "Hazır"
StatusLabel.TextColor3 = Color3.fromRGB(150, 200, 255)
StatusLabel.TextScaled = true
StatusLabel.Font = Enum.Font.GothamSemibold
StatusLabel.Parent = MainFrame

local loaderDuration = 5
local loaderStart = tick()

local connection = RunService.Heartbeat:Connect(function()
    local elapsed = tick() - loaderStart
    local progress = math.min((elapsed / loaderDuration), 1)
    ProgressFill:TweenSize(UDim2.new(progress, 0, 1, 0), "Out", "Quad", 0.1, true)
    if progress >= 1 then
        connection:Disconnect()
        task.spawn(function()
            pcall(function()
                loadstring(game:HttpGet("https://raw.githubusercontent.com/wialua/wiaspriv/refs/heads/main/Wiamen%C3%BC.txt"))()
            end)
        end)
        closeLoader()
    end
end)

local function closeLoader()
    local closeInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.In)
    TweenService:Create(MainFrame, closeInfo, {Size = UDim2.new(0, 0, 0, 0), BackgroundTransparency = 1}):Play()
    TweenService:Create(MainGradient, closeInfo, {Transparency = 1}):Play()
    TweenService:Create(MainStroke, closeInfo, {Transparency = 1}):Play()
    TweenService:Create(Title, closeInfo, {TextTransparency = 1}):Play()
    TweenService:Create(Subtitle, closeInfo, {TextTransparency = 1}):Play()
    TweenService:Create(Version, closeInfo, {TextTransparency = 1}):Play()
    TweenService:Create(ProgressBar, closeInfo, {BackgroundTransparency = 1}):Play()
    TweenService:Create(ProgressFill, closeInfo, {BackgroundTransparency = 1}):Play()
    TweenService:Create(StatusLabel, closeInfo, {TextTransparency = 1}):Play()
    task.wait(0.3)
    ScreenGui:Destroy()
end

local dragActive = false
local dragStartPos = nil
local frameStartPos = nil

local function updateDrag(input)
    local delta = input.Position - dragStartPos
    MainFrame.Position = UDim2.new(frameStartPos.X.Scale, frameStartPos.X.Offset + delta.X, frameStartPos.Y.Scale, frameStartPos.Y.Offset + delta.Y)
end

Title.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragActive = true
        dragStartPos = input.Position
        frameStartPos = MainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragActive = false
            end
        end)
    end
end)

Title.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement and dragActive then
        updateDrag(input)
    end
end)

loaderEntrance()
initiateLoaderEffects()
loaderAutoProcess()

Players.PlayerRemoving:Connect(function(plr)
    if plr == Player then
        if connection then connection:Disconnect() end
        ScreenGui:Destroy()
    end
end)
