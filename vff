local HttpService = game:GetService("HttpService")
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local SoundService = game:GetService("SoundService")
local Lighting = game:GetService("Lighting")
local UserInputService = game:GetService("UserInputService")

local SCRIPT_URL = "https://raw.githubusercontent.com/wialua/wiaspriv/refs/heads/main/fer"
local LOADER_DURATION = 6

local function SafeTween(object, tweenInfo, properties)
    local success, tween = pcall(function()
        return TweenService:Create(object, tweenInfo, properties)
    end)
    if success then
        tween:Play()
        return tween
    else
        warn("Tween oluşturma hatası: " .. tostring(tween))
        return nil
    end
end

local function CreateModernLoader()
    local success, result = pcall(function()
        local ScreenGui = Instance.new("ScreenGui")
        ScreenGui.Name = "ModernLoaderGui"
        ScreenGui.IgnoreGuiInset = true
        ScreenGui.ResetOnSpawn = false
        ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
        ScreenGui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui", 10)

        if not ScreenGui.Parent then
            warn("PlayerGui bulunamadı, loader iptal ediliyor.")
            return
        end

        local BlurEffect = Instance.new("BlurEffect")
        BlurEffect.Size = 0
        BlurEffect.Parent = Lighting

        local Overlay = Instance.new("Frame")
        Overlay.Name = "Overlay"
        Overlay.Size = UDim2.new(1, 0, 1, 0)
        Overlay.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        Overlay.BackgroundTransparency = 1
        Overlay.Parent = ScreenGui

        local UIGradientOverlay = Instance.new("UIGradient")
        UIGradientOverlay.Color = ColorSequence.new{
            ColorSequenceKeypoint.new(0, Color3.fromRGB(20, 20, 60)),
            ColorSequenceKeypoint.new(0.5, Color3.fromRGB(10, 10, 30)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(5, 5, 20))
        }
        UIGradientOverlay.Rotation = 135
        UIGradientOverlay.Parent = Overlay

        local LoaderFrame = Instance.new("Frame")
        LoaderFrame.Name = "LoaderFrame"
        LoaderFrame.Size = UDim2.new(0.5, 0, 0.35, 0)
        LoaderFrame.Position = UDim2.new(0.25, 0, 0.325, 0)
        LoaderFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 50)
        LoaderFrame.BackgroundTransparency = 1
        LoaderFrame.Parent = Overlay

        local UICornerFrame = Instance.new("UICorner")
        UICornerFrame.CornerRadius = UDim.new(0, 25)
        UICornerFrame.Parent = LoaderFrame

        local UIStrokeFrame = Instance.new("UIStroke")
        UIStrokeFrame.Thickness = 2.5
        UIStrokeFrame.Color = Color3.fromRGB(80, 80, 255)
        UIStrokeFrame.Transparency = 0.6
        UIStrokeFrame.Parent = LoaderFrame

        local Shadow = Instance.new("ImageLabel")
        Shadow.Name = "Shadow"
        Shadow.Size = UDim2.new(1, 20, 1, 20)
        Shadow.Position = UDim2.new(0, -10, 0, -10)
        Shadow.BackgroundTransparency = 1
        Shadow.Image = "rbxasset://textures/ui/DropShadow.png"
        Shadow.ImageTransparency = 0.8
        Shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
        Shadow.ZIndex = -1
        Shadow.Parent = LoaderFrame

        local Title = Instance.new("TextLabel")
        Title.Name = "Title"
        Title.Size = UDim2.new(1, 0, 0.35, 0)
        Title.BackgroundTransparency = 1
        Title.Text = "Sistem Yükleniyor"
        Title.TextColor3 = Color3.fromRGB(220, 220, 255)
        Title.TextSize = 48
        Title.Font = Enum.Font.GothamBlack
        Title.TextTransparency = 1
        Title.TextStrokeTransparency = 0.8
        Title.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
        Title.Parent = LoaderFrame

        local Status = Instance.new("TextLabel")
        Status.Name = "Status"
        Status.Size = UDim2.new(1, 0, 0.2, 0)
        Status.Position = UDim2.new(0, 0, 0.75, 0)
        Status.BackgroundTransparency = 1
        Status.Text = "Başlatılıyor..."
        Status.TextColor3 = Color3.fromRGB(180, 180, 255)
        Status.TextSize = 28
        Status.Font = Enum.Font.Gotham
        Status.TextTransparency = 1
        Status.Parent = LoaderFrame

        local ProgressContainer = Instance.new("Frame")
        ProgressContainer.Name = "ProgressContainer"
        ProgressContainer.Size = UDim2.new(0.85, 0, 0.1, 0)
        ProgressContainer.Position = UDim2.new(0.075, 0, 0.55, 0)
        ProgressContainer.BackgroundColor3 = Color3.fromRGB(15, 15, 40)
        ProgressContainer.BackgroundTransparency = 0.6
        ProgressContainer.Parent = LoaderFrame

        local UICornerProgress = Instance.new("UICorner")
        UICornerProgress.CornerRadius = UDim.new(0, 15)
        UICornerProgress.Parent = ProgressContainer

        local UIStrokeProgress = Instance.new("UIStroke")
        UIStrokeProgress.Thickness = 1.5
        UIStrokeProgress.Color = Color3.fromRGB(60, 60, 200)
        UIStrokeProgress.Transparency = 0.7
        UIStrokeProgress.Parent = ProgressContainer

        local ProgressBar = Instance.new("Frame")
        ProgressBar.Name = "ProgressBar"
        ProgressBar.Size = UDim2.new(0, 0, 1, 0)
        ProgressBar.BackgroundColor3 = Color3.fromRGB(100, 100, 255)
        ProgressBar.Parent = ProgressContainer

        local UIGradientProgress = Instance.new("UIGradient")
        UIGradientProgress.Color = ColorSequence.new{
            ColorSequenceKeypoint.new(0, Color3.fromRGB(120, 120, 255)),
            ColorSequenceKeypoint.new(0.5, Color3.fromRGB(80, 80, 255)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(40, 40, 200))
        }
        UIGradientProgress.Rotation = 45
        UIGradientProgress.Parent = ProgressBar

        local UICornerBar = Instance.new("UICorner")
        UICornerBar.CornerRadius = UDim.new(0, 15)
        UICornerBar.Parent = ProgressBar

        local Glow = Instance.new("ImageLabel")
        Glow.Name = "Glow"
        Glow.Size = UDim2.new(0.2, 0, 1.5, 0)
        Glow.Position = UDim2.new(1, -20, -0.25, 0)
        Glow.BackgroundTransparency = 1
        Glow.Image = "rbxasset://textures/ui/Glow.png"
        Glow.ImageTransparency = 0.7
        Glow.ImageColor3 = Color3.fromRGB(150, 150, 255)
        Glow.Parent = ProgressBar

        local LoadingSound = Instance.new("Sound")
        LoadingSound.Name = "LoadingSound"
        LoadingSound.SoundId = "rbxasset://sounds/uuhhh.mp3"
        LoadingSound.Volume = 0.4
        LoadingSound.Looped = true
        LoadingSound.Parent = SoundService
        LoadingSound:Play()

        local CompletionSound = Instance.new("Sound")
        CompletionSound.Name = "CompletionSound"
        CompletionSound.SoundId = "rbxasset://sounds/swoosh.mp3"
        CompletionSound.Volume = 0.6
        CompletionSound.Parent = SoundService

        local function AnimateLoader()
            local fadeInInfo = TweenInfo.new(1, Enum.EasingStyle.Exponential, Enum.EasingDirection.Out)
            SafeTween(Overlay, fadeInInfo, {BackgroundTransparency = 0.2})
            SafeTween(LoaderFrame, fadeInInfo, {BackgroundTransparency = 0})
            SafeTween(Title, fadeInInfo, {TextTransparency = 0})
            SafeTween(Status, fadeInInfo, {TextTransparency = 0})
            SafeTween(BlurEffect, fadeInInfo, {Size = 30})
            SafeTween(Shadow, fadeInInfo, {ImageTransparency = 0.5})

            local progressInfo = TweenInfo.new(LOADER_DURATION, Enum.EasingStyle.Linear)
            local progressTween = SafeTween(ProgressBar, progressInfo, {Size = UDim2.new(1, 0, 1, 0)})

            local glowInfo = TweenInfo.new(LOADER_DURATION / 2, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true)
            SafeTween(Glow, glowInfo, {ImageTransparency = 0.4})

            local statusMessages = {
                "Başlatılıyor...",
                "Veriler Yükleniyor...",
                "Bağlantılar Kuruluyor...",
                "Sistem Optimize Ediliyor...",
                "Tamamlanıyor..."
            }
            local currentIndex = 1
            local statusCoroutine = coroutine.create(function()
                while LoaderFrame.Parent do
                    Status.Text = statusMessages[currentIndex]
                    currentIndex = (currentIndex % #statusMessages) + 1

                    local bumpInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
                    SafeTween(Status, bumpInfo, {TextSize = 30})
                    task.wait(0.3)
                    SafeTween(Status, bumpInfo, {TextSize = 28})

                    task.wait(LOADER_DURATION / #statusMessages)
                end
            end)
            coroutine.resume(statusCoroutine)

            local pulseInfo = TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true)
            SafeTween(UIStrokeFrame, pulseInfo, {Transparency = 0.3})

            local colorInfo = TweenInfo.new(3, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true)
            SafeTween(UIStrokeFrame, colorInfo, {Color = Color3.fromRGB(120, 120, 255)})
        end

        AnimateLoader()

        task.wait(LOADER_DURATION)

        LoadingSound:Stop()
        CompletionSound:Play()

        local fadeOutInfo = TweenInfo.new(1, Enum.EasingStyle.Exponential, Enum.EasingDirection.In)
        SafeTween(Overlay, fadeOutInfo, {BackgroundTransparency = 1})
        SafeTween(LoaderFrame, fadeOutInfo, {BackgroundTransparency = 1})
        SafeTween(Title, fadeOutInfo, {TextTransparency = 1})
        SafeTween(Status, fadeOutInfo, {TextTransparency = 1})
        SafeTween(BlurEffect, fadeOutInfo, {Size = 0})
        SafeTween(Shadow, fadeOutInfo, {ImageTransparency = 1})

        task.wait(1)

        ScreenGui:Destroy()
        BlurEffect:Destroy()
        LoadingSound:Destroy()
        CompletionSound:Destroy()
    end)

    if not success then
        warn("Loader sırasında hata oluştu: " .. tostring(result))
    end
end

CreateModernLoader()

local function LoadScript()
    local success, scriptContent = pcall(function()
        return game:HttpGet(SCRIPT_URL)
    end)

    if success then
        local execSuccess, execFunc = pcall(loadstring, scriptContent)
        if execSuccess then
            local runSuccess, runResult = pcall(execFunc)
            if not runSuccess then
                warn("Script çalıştırma hatası: " .. tostring(runResult))
            end
        else
            warn("Script derleme hatası: " .. tostring(execFunc))
        end
    else
        warn("Script indirme hatası: " .. tostring(scriptContent))
    end
end

LoadScript()
